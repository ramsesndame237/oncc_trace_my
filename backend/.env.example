#==============================================================================
# ONCC TRACE - Backend Environment Configuration
#==============================================================================
# Ce fichier contient toutes les variables d'environnement nécessaires
# Copiez ce fichier vers .env et ajustez les valeurs selon votre environnement
#
# IMPORTANT: Ne commitez JAMAIS le fichier .env avec des vraies valeurs !
#==============================================================================

#------------------------------------------------------------------------------
# 1. CONFIGURATION DE BASE DE L'APPLICATION
#------------------------------------------------------------------------------

# Environnement Node.js
# Valeurs: development | production | qa
NODE_ENV=development

# Port sur lequel l'API écoute
PORT=3333

# Adresse d'écoute
# Development: localhost ou 0.0.0.0
# Production: 0.0.0.0 (pour écouter sur toutes les interfaces)
HOST=0.0.0.0

# Clé secrète de l'application (OBLIGATOIRE)
# Générer avec: node ace generate:key
# IMPORTANT: DOIT être différente en production !
APP_KEY=

# Niveau de logs
# Valeurs: trace | debug | info | warn | error | fatal
LOG_LEVEL=info

# Fuseau horaire
TZ=UTC

#------------------------------------------------------------------------------
# 2. MODE DE DÉPLOIEMENT
#------------------------------------------------------------------------------

# Mode de déploiement de l'application
# Valeurs: dev | qa | production
# - dev: Développement (seeders avec données de test)
# - qa: Assurance qualité (OTP par défaut, seeders QA)
# - production: Production (sécurité maximale, pas de seeders automatiques)
DEPLOY_MODE=qa

# OTP par défaut en mode QA (DANGER: Ne JAMAIS utiliser en production !)
# En mode qa, ce code OTP fonctionnera toujours pour tous les utilisateurs
QA_DEFAULT_OTP=000000

# Mot de passe par défaut pour les utilisateurs créés via seeders
# IMPORTANT: Changer en production !
DEFAULT_PASSWORD=12345678

#------------------------------------------------------------------------------
# 3. CONFIGURATION DOCKER / INITIALISATION
#------------------------------------------------------------------------------

# Mode de seeding lors du démarrage Docker
# Valeurs: dev | test | prod
# - dev: Charge les données de développement (utilisateurs de test, etc.)
# - test: Charge des données minimales pour les tests
# - prod: Charge uniquement les données essentielles (roles, permissions)
# SEED_MODE=dev

# Exécuter automatiquement les migrations et seeders au démarrage du conteneur
# Valeurs: true | false
# Development: true (pratique pour le développement)
# Production: false (migration manuelle recommandée)
# RUN_SEEDERS=true

# Forcer la réinitialisation complète de la DB au démarrage
# DANGER: Supprime TOUTES les données ! (rollback + migrations + seeders)
# Valeurs: true | false
# Development: false (sauf si vous voulez repartir de zéro)
# Production: JAMAIS true !
# RESET_DATABASE=false

#------------------------------------------------------------------------------
# 4. BASE DE DONNÉES (PostgreSQL 15)
#------------------------------------------------------------------------------

# Hôte de la base de données
# Development local: localhost
# Development Docker: postgres (nom du service Docker)
# Production: IP ou nom d'hôte du serveur PostgreSQL
DB_HOST=postgres

# Port PostgreSQL (défaut: 5432)
DB_PORT=5432

# Nom d'utilisateur PostgreSQL
DB_USER=sifc_user

# Mot de passe PostgreSQL
# IMPORTANT: Utiliser un mot de passe fort en production !
DB_PASSWORD=sifc_password

# Nom de la base de données
DB_DATABASE=sifc_db

#------------------------------------------------------------------------------
# 5. REDIS (Cache et Sessions)
#------------------------------------------------------------------------------

# Hôte Redis
# Development local: localhost ou 127.0.0.1
# Development Docker: redis (nom du service Docker)
# Production: IP ou nom d'hôte du serveur Redis
REDIS_HOST=redis

# Port Redis (défaut: 6379)
REDIS_PORT=6379

# Mot de passe Redis (optionnel en dev, OBLIGATOIRE en production)
REDIS_PASSWORD=

# Base de données Redis principale (0-15)
REDIS_DB=0

# Base de données Redis pour les sessions utilisateur
REDIS_SESSION_DB=1

# Base de données Redis pour le cache applicatif
REDIS_CACHE_DB=2

# Préfixe pour toutes les clés Redis (évite les conflits)
REDIS_KEY_PREFIX=sifc:

#------------------------------------------------------------------------------
# 6. MINIO (Stockage de fichiers S3-compatible)
#------------------------------------------------------------------------------

# Endpoint MinIO (serveur)
# Development local: localhost
# Development Docker: minio (nom du service Docker)
# Production: IP ou nom d'hôte du serveur MinIO
MINIO_ENDPOINT=minio

# Port du service MinIO (défaut: 9000)
MINIO_PORT=9000

# Clé d'accès MinIO (comme AWS Access Key)
# IMPORTANT: Changer en production !
MINIO_ACCESS_KEY=sifc_minio_user

# Clé secrète MinIO (comme AWS Secret Key)
# IMPORTANT: Changer en production avec une valeur forte !
MINIO_SECRET_KEY=sifc_minio_password

# Utiliser SSL/TLS pour MinIO
# Development: false
# Production: true (recommandé)
MINIO_USE_SSL=false

# Nom du bucket principal pour les documents
MINIO_BUCKET=sifc-documents

# Port de la console web MinIO (défaut: 9001)
MINIO_CONSOLE_PORT=9001

# Endpoint public pour les URLs accessibles depuis le navigateur
# Development: localhost
# Production: nom de domaine public (ex: storage.oncc.cm)
# Utilisé pour générer les URLs de téléchargement de documents
MINIO_PUBLIC_ENDPOINT=localhost

#------------------------------------------------------------------------------
# 7. SESSIONS
#------------------------------------------------------------------------------

# Driver de session
# Valeurs: cookie | redis
# Development: cookie (simple)
# Production: redis (recommandé pour la scalabilité)
SESSION_DRIVER=cookie

#------------------------------------------------------------------------------
# 8. BRANDING DE L'APPLICATION
#------------------------------------------------------------------------------

# Nom de l'application (affiché dans les emails, etc.)
APP_NAME=ONCC TRACE

# Email de support (affiché dans les emails)
SUPPORT_EMAIL=support@oncc.cm

# Téléphone de support (affiché dans les emails)
# Si non défini ou vide, le numéro de téléphone ne sera pas affiché dans les emails
# Laisser vide si vous ne souhaitez pas afficher de numéro de téléphone
SUPPORT_PHONE=

#------------------------------------------------------------------------------
# 9. FRONTEND
#------------------------------------------------------------------------------

# URL du frontend (pour les liens dans les emails, CORS, etc.)
# Development: http://localhost:3000
# Production: https://app.oncc.cm (ou votre domaine)
FRONTEND_URL=http://localhost:3000

#------------------------------------------------------------------------------
# 10. CONFIGURATION EMAIL
#------------------------------------------------------------------------------

# Provider d'email
# Valeurs: smtp | sendgrid
# Development: smtp (avec MailHog local)
# Production: sendgrid (ou smtp avec SendGrid/autre provider)
MAIL_MAILER=smtp

#----------------------------------
# Configuration de l'expéditeur
#----------------------------------

# Email d'envoi (FROM)
# Nouvelle variable recommandée (remplace SENDGRID_FROM_EMAIL)
SENDER_EMAIL=noreply@oncc.cm

# Nom de l'expéditeur (FROM NAME)
# Nouvelle variable recommandée (remplace SENDGRID_FROM_NAME)
SENDER_NAME=ONCC TRACE

# DEPRECATED: Utilisez SENDER_EMAIL et SENDER_NAME à la place
# Ces variables sont conservées pour compatibilité rétroactive
# SENDGRID_FROM_EMAIL=noreply@oncc.cm
# SENDGRID_FROM_NAME=ONCC TRACE

#----------------------------------
# Configuration SMTP
#----------------------------------

# Hôte SMTP
# Development local avec MailHog: localhost
# Development Docker avec MailHog: mailhog
# Production avec SendGrid: smtp.sendgrid.net
# Production avec Gmail: smtp.gmail.com
# Production avec Outlook: smtp-mail.outlook.com
SMTP_HOST=mailhog

# Port SMTP
# MailHog: 1025
# SendGrid: 587 (TLS) ou 465 (SSL)
# Gmail: 587 (TLS) ou 465 (SSL)
# SMTP TLS standard: 587
# SMTP SSL standard: 465
SMTP_PORT=1025

# Nom d'utilisateur SMTP
# MailHog: laisser vide
# SendGrid: apikey (littéralement le mot "apikey")
# Gmail: votre adresse email complète
# Outlook: votre adresse email complète
SMTP_USER=

# DEPRECATED: Utilisez SMTP_USER à la place
# Cette variable est conservée pour compatibilité rétroactive
# SMTP_USERNAME=

# Mot de passe SMTP
# MailHog: laisser vide
# SendGrid: votre clé API SendGrid (voir SENDGRID_API_KEY ci-dessous)
# Gmail: mot de passe d'application (https://myaccount.google.com/apppasswords)
# Outlook: mot de passe d'application
# IMPORTANT: Ne JAMAIS utiliser votre mot de passe principal !
SMTP_PASSWORD=

#----------------------------------
# Configuration SendGrid (Production)
#----------------------------------

# Clé API SendGrid
# Obtenir sur: https://app.sendgrid.com/settings/api_keys
# En production avec SendGrid:
# - MAIL_MAILER=sendgrid (ou smtp)
# - SMTP_HOST=smtp.sendgrid.net
# - SMTP_PORT=587
# - SMTP_USER=apikey
# - SMTP_PASSWORD=<votre clé API ici> (ou SENDGRID_API_KEY)
# Development: laisser vide si vous utilisez MailHog
SENDGRID_API_KEY=

#----------------------------------
# Exemple de configuration SendGrid Production
#----------------------------------
# MAIL_MAILER=sendgrid
# SENDER_EMAIL=hello@votre-domaine.com
# SENDER_NAME=Votre Application
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxxx.yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy

#==============================================================================
# EXEMPLES DE CONFIGURATION PAR ENVIRONNEMENT
#==============================================================================

#------------------------------------------------------------------------------
# EXEMPLE: Configuration DÉVELOPPEMENT LOCAL (sans Docker)
#------------------------------------------------------------------------------
# NODE_ENV=development
# DEPLOY_MODE=dev
# HOST=localhost
# DB_HOST=localhost
# REDIS_HOST=localhost
# MINIO_ENDPOINT=localhost
# MINIO_PUBLIC_ENDPOINT=localhost
# SMTP_HOST=localhost
# FRONTEND_URL=http://localhost:3000

#------------------------------------------------------------------------------
# EXEMPLE: Configuration DÉVELOPPEMENT DOCKER
#------------------------------------------------------------------------------
# NODE_ENV=development
# DEPLOY_MODE=qa
# HOST=0.0.0.0
# DB_HOST=postgres
# REDIS_HOST=redis
# MINIO_ENDPOINT=minio
# MINIO_PUBLIC_ENDPOINT=localhost
# SMTP_HOST=mailhog
# FRONTEND_URL=http://localhost:3000
# RUN_SEEDERS=true
# SEED_MODE=dev

#------------------------------------------------------------------------------
# EXEMPLE: Configuration PRODUCTION
#------------------------------------------------------------------------------
# NODE_ENV=production
# DEPLOY_MODE=production
# HOST=0.0.0.0
# APP_KEY=<généré avec node ace generate:key>
# LOG_LEVEL=warn
#
# # Base de données Production
# DB_HOST=production-db.example.com
# DB_PORT=5432
# DB_USER=oncc_prod_user
# DB_PASSWORD=<mot de passe fort et unique>
# DB_DATABASE=oncc_production
#
# # Redis Production
# REDIS_HOST=production-redis.example.com
# REDIS_PORT=6379
# REDIS_PASSWORD=<mot de passe fort et unique>
# REDIS_KEY_PREFIX=oncc:prod:
#
# # MinIO Production
# MINIO_ENDPOINT=storage.oncc.cm
# MINIO_PORT=443
# MINIO_ACCESS_KEY=<généré de manière sécurisée>
# MINIO_SECRET_KEY=<généré de manière sécurisée>
# MINIO_USE_SSL=true
# MINIO_PUBLIC_ENDPOINT=storage.oncc.cm
#
# # Email Production (SendGrid)
# MAIL_MAILER=sendgrid
# SENDGRID_API_KEY=<votre clé API SendGrid>
# SENDGRID_FROM_EMAIL=noreply@oncc.cm
#
# # Frontend Production
# FRONTEND_URL=https://app.oncc.cm
#
# # Sécurité Production
# SESSION_DRIVER=redis
# DEFAULT_PASSWORD=<désactivé en production>
# QA_DEFAULT_OTP=<désactivé en production>

#==============================================================================
# NOTES DE SÉCURITÉ
#==============================================================================
# 1. Ne jamais commiter le fichier .env dans Git
# 2. Utiliser des mots de passe forts en production (minimum 32 caractères)
# 3. Générer une nouvelle APP_KEY unique pour chaque environnement
# 4. Activer SSL/TLS en production (MINIO_USE_SSL=true)
# 5. Désactiver QA_DEFAULT_OTP en production
# 6. Utiliser des variables d'environnement système ou un vault en production
# 7. Restreindre les accès réseau (firewall) aux services
# 8. Sauvegarder régulièrement les bases de données
# 9. Monitorer les logs en production
# 10. Mettre en place une rotation des secrets régulière
